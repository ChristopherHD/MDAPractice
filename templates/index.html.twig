<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>G-Med:{% block title %}Portal{% endblock %}</title>
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="{{ asset('index.css') }}">
        {% block stylesheets %}{% endblock %}
    </head>
    <body>
    <nav class="header">
        <div class="logo"><a href="{{ path("index") }}"><img src="https://image.flaticon.com/icons/svg/119/119058.svg" class="svg-inject" alt="Logo" /></a><a href="{{ path("index") }}">G-Med</a></div>
        <div class="page-title">{% block page_title %}Portal{% endblock %}</div>
        <ul class="menu">
            {% block menu_items_start %}{% endblock %}
            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                {% if is_granted('ROLE_DOCTOR') %}
                    <li class="has-children"><a href="#">&nbsp;Appointments&nbsp;</a>
                        <ul>
                            <li class=""><a href="{{ path("appointments") }}">My Appointments</a></li>
                            <li class=""><a href="{{ path("oldAppointments") }}">Old Appointments</a></li>
                        </ul>
                    </li>
                    <li><a href="{{ path("account") }}">&nbsp;Account&nbsp;</a></li>
                {% elseif is_granted('ROLE_USER') %}
                    <li><a href="{{ path("searchDoctor") }}">&nbsp;Search Doctor&nbsp;</a></li>
                    <li class="has-children"><a href="#">&nbsp;Appointments&nbsp;</a>
                        <ul>
                            <li class=""><a href="{{ path("appointments") }}">My Appointments</a></li>
                            <li class=""><a href="{{ path("selectSpecialty") }}">New Appointment</a></li>
                            <li class=""><a href="{{ path("oldAppointments") }}">Old Appointments</a></li>
                        </ul>
                    </li>
                    <li><a href="{{ path("account") }}">&nbsp;Account&nbsp;</a></li>
                {% elseif is_granted('ROLE_ADMIN') %}
                    <li><a href="{{ path("addDoctor") }}">&nbsp;New Doctor&nbsp;</a></li>
                {% endif %}
				<li><a href="{{ path("logout") }}">&nbsp;Log-out&nbsp;</a></li>
            {% else %}
                <li><a href="{{ path("addUser") }}">&nbsp;Sign-up&nbsp;</a></li>
                <li><a href="{{ path("login") }}">&nbsp;Log-in&nbsp;</a></li>
            {% endif %}
            {% block menu_items_end %}{% endblock %}
        </ul>
    </nav>
        <div class="content">
        {% block content %}
			{% if appointments is not defined %}
				<div class="block">
					<div class="block-title">Welcome!</div>
					<div class="center">Under Construction</div>
				</div>
			{% else %}
				{% for appoint in appointments %}
					{% if date(appoint.date) < date("+3days") and date(appoint.date) > date() %}
						<div class="block">
							<div class="block-title-alert"> 
								{{ appoint.date | date('m-d-Y H:i:s') }} (<a class="redhover" href='{{ path("removeAppointment") }}?id={{ appoint.id }}'>remove</a>)</div>
							<div class="center">
								<div class="profile-table">
									<div class="column">
										{% if is_granted('ROLE_USER') %}
											<div><b>Doctor:&nbsp;&nbsp;</b><a class="orangehover" href="#">{{ appoint.doctor.username }}</a></div>
											<div><b>Specialty:&nbsp;&nbsp;</b>{{ appoint.doctor.specialty }} </div>
										{% elseif is_granted('ROLE_DOCTOR') %}
											<div><b>Patient:&nbsp;&nbsp;</b><a class="orangehover" href="#">{{ appoint.patient.username }}</a></div>
										{% endif %}
										{% if appoint.getAnimal().name is defined %}
											<div><b>Animal:&nbsp;&nbsp;</b><a class="orangehover" href="{{ path("getAnimal",{'id':appoint.getAnimal().getId()}) }}">{{ appoint.getAnimal().name }}</a></div>
										{% endif %}
									</div>
									<div class="column">
									{% if appoint.description is not empty %}
										<div><b> Description:&nbsp;&nbsp;</b>{{ appoint.description }} </div>
									{% endif %}
									</div>
								</div>
								<div class="center">
									{% if date(appoint.date) < date('+3days') %} <div class="text-red"><b>Appointment in less than 3 days</b></div> {% endif %}
								</div>
							</div>
						</div>	
					{% endif %}
				{% endfor %}
			{% endif %}
        {% endblock %}
        </div>
    <div class="footer">Symfony&ensp;Web&ensp;created&ensp;by&ensp;Elio García,&ensp;Samuel Falcón&ensp;and&ensp;Christopher&ensp;-&ensp;2018</div>
    </body>
</html>
